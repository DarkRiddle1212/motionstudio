var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);new class{constructor(){e(this,"metrics",[]),e(this,"componentMetrics",new Map),e(this,"networkMetrics",[]),e(this,"memoryMetrics",[]),e(this,"observers",[]),e(this,"isEnabled",!0),e(this,"maxMetrics",1e3),this.initializeObservers(),this.startMemoryMonitoring()}setEnabled(t){this.isEnabled=t}recordMetric(t,e,s){if(!this.isEnabled)return;const i={name:t,value:e,timestamp:Date.now(),metadata:s};this.metrics.push(i),this.trimMetrics()}recordComponentMetric(t,e,s=!1){if(!this.isEnabled)return;const i=this.componentMetrics.get(t),r=Date.now();i?(i.renderTime=e,i.updateCount++,i.lastUpdate=r,s&&(i.mountTime=e)):this.componentMetrics.set(t,{componentName:t,renderTime:e,mountTime:s?e:void 0,updateCount:1,lastUpdate:r})}recordNetworkMetric(t,e,s,i,r){if(!this.isEnabled)return;const n={url:t,method:e,duration:s,status:i,size:r,timestamp:Date.now()};this.networkMetrics.push(n),this.networkMetrics.length>this.maxMetrics&&(this.networkMetrics=this.networkMetrics.slice(-this.maxMetrics))}getSummary(){const t=Date.now(),e=t-3e5,s=this.metrics.filter(t=>t.timestamp>e),i=this.networkMetrics.filter(t=>t.timestamp>e),r=Array.from(this.componentMetrics.values()).sort((t,e)=>e.renderTime-t.renderTime).slice(0,10),n=i.length>0?i.reduce((t,e)=>t+e.duration,0)/i.length:0,o=i.filter(t=>t.duration>1e3).sort((t,e)=>e.duration-t.duration).slice(0,5),a=this.memoryMetrics[this.memoryMetrics.length-1],h=this.getCoreWebVitals();return{timestamp:t,metrics:{total:this.metrics.length,recent:s.length},components:{tracked:this.componentMetrics.size,slowest:r},network:{totalRequests:this.networkMetrics.length,recentRequests:i.length,averageTime:Math.round(n),slowRequests:o},memory:a,coreWebVitals:h}}getCoreWebVitals(){const t={},e=performance.getEntriesByType("largest-contentful-paint");e.length>0&&(t.lcp=e[e.length-1].startTime);const s=performance.getEntriesByType("first-input");if(s.length>0){const e=s[0];t.fid=e.processingStart-e.startTime}const i=performance.getEntriesByType("layout-shift");return i.length>0&&(t.cls=i.reduce((t,e)=>e.hadRecentInput?t:t+e.value,0)),t}initializeObservers(){if("undefined"!=typeof PerformanceObserver)try{const t=new PerformanceObserver(t=>{for(const e of t.getEntries())if("navigation"===e.entryType){const t=e;this.recordMetric("page-load-time",t.loadEventEnd-t.fetchStart),this.recordMetric("dom-content-loaded",t.domContentLoadedEventEnd-t.fetchStart),this.recordMetric("first-paint",t.responseEnd-t.fetchStart)}});t.observe({entryTypes:["navigation"]}),this.observers.push(t);const e=new PerformanceObserver(t=>{for(const e of t.getEntries())if("resource"===e.entryType){const t=e;this.recordNetworkMetric(t.name,"GET",t.responseEnd-t.fetchStart,200,t.transferSize)}});e.observe({entryTypes:["resource"]}),this.observers.push(e);const s=new PerformanceObserver(t=>{for(const e of t.getEntries())"longtask"===e.entryType&&this.recordMetric("long-task",e.duration,{startTime:e.startTime})});s.observe({entryTypes:["longtask"]}),this.observers.push(s)}catch(t){}}startMemoryMonitoring(){const t=()=>{if(!this.isEnabled)return;const t=performance.memory;if(t){const e={usedJSHeapSize:t.usedJSHeapSize,totalJSHeapSize:t.totalJSHeapSize,jsHeapSizeLimit:t.jsHeapSizeLimit,timestamp:Date.now()};this.memoryMetrics.push(e),this.memoryMetrics.length>100&&(this.memoryMetrics=this.memoryMetrics.slice(-100))}};setInterval(t,3e4),t()}trimMetrics(){this.metrics.length>this.maxMetrics&&(this.metrics=this.metrics.slice(-this.maxMetrics))}exportMetrics(){return{metrics:this.metrics,componentMetrics:Array.from(this.componentMetrics.values()),networkMetrics:this.networkMetrics,memoryMetrics:this.memoryMetrics,summary:this.getSummary()}}clear(){this.metrics=[],this.componentMetrics.clear(),this.networkMetrics=[],this.memoryMetrics=[]}disconnect(){this.observers.forEach(t=>t.disconnect()),this.observers=[]}},new class{constructor(t={}){e(this,"cache",new Map),e(this,"config"),e(this,"accessOrder",[]),this.config={defaultTTL:3e5,maxSize:100,enablePersistence:!0,...t},this.config.enablePersistence&&this.loadFromStorage(),setInterval(()=>this.cleanup(),6e4)}get(t){const e=this.cache.get(t);return e?Date.now()>e.expiresAt?(this.cache.delete(t),this.removeFromAccessOrder(t),null):(this.updateAccessOrder(t),e.data):null}set(t,e,s){const i=Date.now(),r=i+(s||this.config.defaultTTL);this.cache.size>=this.config.maxSize&&!this.cache.has(t)&&this.evictLRU();const n={data:e,timestamp:i,expiresAt:r};this.cache.set(t,n),this.updateAccessOrder(t),this.config.enablePersistence&&this.saveToStorage()}delete(t){const e=this.cache.delete(t);return e&&(this.removeFromAccessOrder(t),this.config.enablePersistence&&this.saveToStorage()),e}clear(){this.cache.clear(),this.accessOrder=[],this.config.enablePersistence&&localStorage.removeItem("admin-cache")}has(t){return null!==this.get(t)}getStats(){const t=Date.now();let e=0;for(const[,s]of this.cache)t>s.expiresAt&&e++;return{size:this.cache.size,maxSize:this.config.maxSize,expiredCount:e,hitRate:this.calculateHitRate()}}invalidatePattern(t){let e=0;const s=[];for(const i of this.cache.keys())t.test(i)&&s.push(i);return s.forEach(t=>{this.delete(t),e++}),e}updateAccessOrder(t){this.removeFromAccessOrder(t),this.accessOrder.push(t)}removeFromAccessOrder(t){const e=this.accessOrder.indexOf(t);e>-1&&this.accessOrder.splice(e,1)}evictLRU(){if(this.accessOrder.length>0){const t=this.accessOrder[0];this.cache.delete(t),this.accessOrder.shift()}}cleanup(){const t=Date.now(),e=[];for(const[s,i]of this.cache)t>i.expiresAt&&e.push(s);e.forEach(t=>this.delete(t))}saveToStorage(){try{const t={entries:Array.from(this.cache.entries()),accessOrder:this.accessOrder};localStorage.setItem("admin-cache",JSON.stringify(t))}catch(t){}}loadFromStorage(){try{const t=localStorage.getItem("admin-cache");if(t){const e=JSON.parse(t);this.cache=new Map(e.entries),this.accessOrder=e.accessOrder||[],this.cleanup()}}catch(t){localStorage.removeItem("admin-cache")}}calculateHitRate(){return 0}};
