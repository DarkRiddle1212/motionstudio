import{j as e,c as a,a as t,r as s}from"./chunk-CJk5566G.js";import{C as n,h as r,c as l,u as i,F as c,e as d,d as m,i as o,I as h}from"./chunk-6oSn1JRi.js";const x=({lesson:a,onClick:t,className:s=""})=>{const i=()=>{t(a.id)};return e.jsx(n,{className:`cursor-pointer transition-all duration-200 hover:shadow-lg hover:border-brand-accent ${s}`,onClick:i,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-brand-secondary-bg text-brand-primary-text rounded-full text-sm font-medium",children:a.order}),e.jsx("h3",{className:"text-lg font-semibold text-brand-primary-text font-serif",children:a.title})]}),a.isCompleted&&e.jsx(r,{variant:"success",className:"text-xs",children:"âœ“ Completed"})]}),e.jsx("p",{className:"text-brand-secondary-text mb-4 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-brand-secondary-text mb-4",children:[a.videoUrl&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),e.jsx("span",{children:"Video"})]}),a.fileUrls.length>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsxs("span",{children:[a.fileUrls.length," file",1!==a.fileUrls.length?"s":""]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(l,{variant:"tertiary",size:"sm",onClick:i,className:"text-brand-accent hover:text-brand-accent",children:a.isCompleted?"Review Lesson":"Start Lesson"}),a.completedAt&&e.jsxs("span",{className:"text-xs text-brand-secondary-text",children:["Completed ",new Date(a.completedAt).toLocaleDateString()]})]})]})})},b="http://localhost:5000/api",u=Object.freeze(Object.defineProperty({__proto__:null,LessonCard:x,LessonView:({courseId:n})=>{const{lessonId:o,courseId:h}=a(),x=t(),{token:u}=i(),p=n||h,[f,v]=s.useState(null),[y,N]=s.useState(!0),[w,g]=s.useState(null),[C,k]=s.useState(!1),[z,j]=s.useState(!1);s.useEffect(()=>{o&&u&&R()},[o,u]);const R=async()=>{try{N(!0),g(null);const e=await fetch(`${b}/lessons/${o}`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to fetch lesson")}const a=await e.json();v(a.lesson)}catch(e){g(e instanceof Error?e.message:"An error occurred")}finally{N(!1)}},L=()=>{x(p?`/courses/${p}`:"/dashboard")};return y?e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-accent mx-auto mb-4"}),e.jsx("p",{className:"text-brand-secondary-text",children:"Loading lesson..."})]})}):w?e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("h2",{className:"text-xl font-semibold text-brand-primary-text mb-2 font-serif",children:"Unable to Load Lesson"}),e.jsx("p",{className:"text-brand-secondary-text mb-6",children:w}),e.jsx(l,{onClick:L,children:"Back to Course"})]})}):f?e.jsx("div",{className:"min-h-screen bg-brand-primary-bg",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx(c,{children:e.jsxs("div",{className:"mb-8",children:[e.jsx(l,{variant:"tertiary",onClick:L,className:"mb-4 text-brand-accent hover:text-brand-accent",children:"â† Back to Course"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-secondary text-primary-text rounded-full font-medium",children:f.order}),e.jsx("h1",{className:"text-3xl font-bold text-primary-text font-serif",children:f.title})]}),e.jsx("p",{className:"text-lg text-secondary-text",children:f.description})]}),f.isCompleted&&e.jsx(r,{variant:"success",className:"ml-4",children:"âœ“ Completed"})]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 mb-8",children:[f.videoUrl&&(B=f.videoUrl,e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden",children:e.jsxs("video",{controls:!0,className:"w-full h-full object-cover",poster:"/api/placeholder/800/450",children:[e.jsx("source",{src:B,type:"video/mp4"}),"Your browser does not support the video tag."]})})})),f.content&&($=f.content,e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"prose prose-lg max-w-none text-primary-text",dangerouslySetInnerHTML:{t:$}})})),f.fileUrls.length>0&&(S=f.fileUrls,e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4 font-serif",children:"Course Materials"}),e.jsx("div",{className:"space-y-2",children:S.map((a,t)=>{const s=a.split("/").pop()||`File ${t+1}`;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-secondary rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("svg",{className:"w-5 h-5 text-accent",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-primary-text",children:s})]}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>window.open(a,"_blank"),children:"Download"})]},t)})})]}))]})}),!f.isCompleted&&e.jsx(d,{children:e.jsx("div",{className:"text-center",children:e.jsx(l,{onClick:async()=>{if(f&&!f.isCompleted&&!C)try{k(!0);const e=await fetch(`${b}/lessons/${f.id}/complete`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to complete lesson")}v(e=>e?{...e,isCompleted:!0,completedAt:(new Date).toISOString()}:null),j(!0)}catch(e){g(e instanceof Error?e.message:"Failed to complete lesson")}finally{k(!1)}},disabled:C,className:"px-8 py-3 text-lg",children:C?"Completing...":"Mark as Complete"})})}),e.jsx(m,{isOpen:z,onClose:()=>j(!1),title:"Lesson Completed!",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"text-green-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2 font-serif",children:"Great job!"}),e.jsxs("p",{className:"text-secondary-text mb-6",children:["You've successfully completed \"",f.title,'". Your progress has been updated.']}),e.jsxs("div",{className:"flex space-x-3 justify-center",children:[e.jsx(l,{variant:"secondary",onClick:()=>j(!1),children:"Continue Learning"}),e.jsx(l,{onClick:L,children:"Back to Course"})]})]})})]})}):e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-brand-secondary-text",children:"Lesson not found"})})});var S,$,B}},Symbol.toStringTag,{value:"Module"})),p="http://localhost:5000/api",f=Object.freeze(Object.defineProperty({__proto__:null,AssignmentCard:({assignment:a,onClick:t,showCourse:s=!1,className:i=""})=>{const c=(()=>{const e=new Date(a.deadline),t=new Date,s=e.getTime()-t.getTime(),n=Math.ceil(s/864e5);return n<0?{status:"overdue",text:"Overdue",variant:"danger"}:0===n?{status:"due-today",text:"Due Today",variant:"warning"}:n<=3?{status:"due-soon",text:`Due in ${n} day${n>1?"s":""}`,variant:"warning"}:{status:"upcoming",text:`Due in ${n} days`,variant:"default"}})();return e.jsx(n,{className:`cursor-pointer transition-all duration-200 hover:shadow-lg hover:border-brand-accent ${i}`,onClick:()=>t(a.id),hoverable:!0,"data-testid":`assignment-card-${a.id}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-primary-text font-serif mb-1",children:a.title}),s&&a.course&&e.jsxs("p",{className:"text-sm text-brand-secondary-text mb-2",children:["ðŸ“š ",a.course.title]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(r,{variant:"default",children:a.submissionType}),e.jsx(r,{variant:c.variant,children:c.text})]})]}),e.jsx("p",{className:"text-brand-secondary-text mb-4 leading-relaxed",children:((e,a=120)=>e.length<=a?e:e.substring(0,a).trim()+"...")(a.description)}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-brand-secondary-text",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),(d=a.deadline,new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}))]}),a.l&&e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),e.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2v1a2 2 0 002 2h4a2 2 0 002-2V3a2 2 0 012 2v6a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3z",clipRule:"evenodd"})]}),a.l.submissions," submission",1!==a.l.submissions?"s":""]})]}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:e=>{e.stopPropagation(),t(a.id)},className:"text-brand-accent hover:text-brand-accent",children:"View Assignment"})]})]})});var d},AssignmentView:()=>{const{assignmentId:x}=a(),b=t(),{token:u}=i(),[f,v]=s.useState(null),[y,N]=s.useState(null),[w,g]=s.useState(!0),[C,k]=s.useState(null),[z,j]=s.useState(!1),[R,L]=s.useState(!1),[S,$]=s.useState("file"),[B,V]=s.useState(""),[A,D]=s.useState([]),[M,T]=s.useState({});s.useEffect(()=>{x&&u&&(F(),H())},[x,u]);const F=async()=>{try{g(!0),k(null);const e=await fetch(`${p}/assignments/${x}`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to fetch assignment")}const a=await e.json();v(a.assignment),$(a.assignment.submissionType)}catch(e){k(e instanceof Error?e.message:"An error occurred")}finally{g(!1)}},H=async()=>{try{const e=await fetch(`${p}/students/submissions`,{headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"}});if(e.ok){const a=(await e.json()).submissions.find(e=>e.assignmentId===x);a&&N(a)}}catch(e){}},O=()=>{(null==f?void 0:f.course.id)?b(`/courses/${f.course.id}/content`):b("/dashboard")};if(w)return e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{"data-testid":"loading-spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-accent mx-auto mb-4"}),e.jsx("p",{className:"text-brand-secondary-text",children:"Loading assignment..."})]})});if(C)return e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("h2",{className:"text-xl font-semibold text-brand-primary-text mb-2 font-serif",children:"Unable to Load Assignment"}),e.jsx("p",{className:"text-brand-secondary-text mb-6",children:C}),e.jsx(l,{onClick:O,children:"Back to Course"})]})});if(!f)return e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-brand-secondary-text",children:"Assignment not found"})})});const _=(()=>{if(!f)return"";const e=new Date(f.deadline),a=new Date,t=e.getTime()-a.getTime(),s=Math.ceil(t/864e5);return s<0?"overdue":0===s?"due-today":s<=3?"due-soon":"upcoming"})();return e.jsx("div",{className:"min-h-screen bg-brand-primary-bg",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6 sm:py-8",children:[e.jsx(c,{children:e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx(l,{variant:"tertiary",onClick:O,className:"mb-4 text-brand-accent hover:text-brand-accent",children:"â† Back to Course"}),e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between mb-4 sm:mb-6 space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-3 mb-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-brand-primary-text font-serif",children:f.title}),e.jsx(r,{variant:(e=>{switch(e){case"overdue":return"danger";case"due-today":case"due-soon":return"warning";default:return"default"}})(_),className:"mt-2 sm:mt-0 self-start",children:f.submissionType})]}),e.jsx("p",{className:"text-base sm:text-lg text-brand-secondary-text mb-4",children:f.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-6 text-xs sm:text-sm text-brand-secondary-text",children:[e.jsxs("span",{children:["ðŸ“š ",f.course.title]}),e.jsxs("span",{children:["ðŸ“… Due: ",new Date(f.deadline).toLocaleDateString()]}),e.jsxs("span",{className:"hidden sm:inline",children:["ðŸ“ ",f.l.submissions," submissions"]})]})]}),y&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(r,{variant:"late"===y.status?"warning":"success",children:"submitted"===y.status?"âœ“ Submitted":"late"===y.status?"âš  Late":"reviewed"===y.status?"âœ“ Reviewed":y.status})})]}),"overdue"===_&&!y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("svg",{className:"w-5 h-5 text-red-500 mr-2 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-red-700 text-sm sm:text-base",children:"This assignment is overdue. Submissions will be marked as late."})]})})]})}),y&&e.jsx(d,{children:e.jsx(n,{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-brand-primary-text font-serif mb-4",children:"Your Submission"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("span",{className:"text-brand-secondary-text font-medium sm:font-normal",children:"Submitted:"}),e.jsx("span",{className:"text-brand-primary-text text-sm sm:text-base",children:new Date(y.submittedAt).toLocaleString()})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("span",{className:"text-brand-secondary-text font-medium sm:font-normal",children:"Type:"}),e.jsx("span",{className:"text-brand-primary-text capitalize",children:y.submissionType})]}),y.fileUrl&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("span",{className:"text-brand-secondary-text font-medium sm:font-normal",children:"File:"}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>window.open(y.fileUrl,"_blank"),className:"text-brand-accent hover:text-brand-accent mt-1 sm:mt-0 self-start sm:self-auto",children:"View File"})]}),y.linkUrl&&e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("span",{className:"text-brand-secondary-text font-medium sm:font-normal",children:"Link:"}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>window.open(y.linkUrl,"_blank"),className:"text-brand-accent hover:text-brand-accent mt-1 sm:mt-0 self-start sm:self-auto",children:"Open Link"})]}),y.feedback&&y.feedback.length>0&&e.jsxs("div",{className:"mt-4 sm:mt-6 pt-4 sm:pt-6 border-t border-brand-accent border-opacity-20",children:[e.jsx("h4",{className:"text-sm sm:text-base font-semibold text-brand-primary-text font-serif mb-3",children:"Instructor Feedback"}),y.feedback.map(a=>e.jsxs("div",{className:"bg-brand-primary-bg rounded-lg p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-brand-primary-text",children:[a.instructor.firstName," ",a.instructor.lastName]}),e.jsx("span",{className:"text-xs sm:text-sm text-brand-secondary-text",children:new Date(a.createdAt).toLocaleDateString()})]}),e.jsx("p",{className:"text-brand-secondary-text text-sm sm:text-base",children:a.comment}),a.rating&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-sm text-brand-secondary-text",children:"Rating: "}),e.jsxs("span",{className:"text-brand-accent font-medium",children:[a.rating,"/5"]})]})]},a.id))]})]})]})})}),!y&&e.jsx(d,{children:e.jsx(n,{children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-brand-primary-text font-serif mb-4 sm:mb-6",children:"Submit Assignment"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return"file"===S?0===A.length&&(e.file="Please select a file to upload"):"link"===S&&(B.trim()?(e=>{try{return new URL(e),!0}catch{return!1}})(B)||(e.link="Please enter a valid URL format"):e.link="Please enter a valid URL"),T(e),0===Object.keys(e).length})())try{j(!0),k(null);let e={assignmentId:x,submissionType:S};"file"===S&&A.length>0?e.fileUrl=`https://example.com/uploads/${A[0].name}`:"link"===S&&(e.linkUrl=B);const a=await fetch(`${p}/assignments/${x}/submit`,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){const e=await a.json();throw new Error(e.error||"Failed to submit assignment")}const t=await a.json();N(t.submission),L(!0),D([]),V(""),T({})}catch(a){k(a instanceof Error?a.message:"Failed to submit assignment")}finally{j(!1)}},className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-brand-primary-text mb-3",children:"Submission Type"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-4 space-y-2 sm:space-y-0",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"file",checked:"file"===S,onChange:e=>$(e.target.value),className:"mr-2 text-brand-accent focus:ring-brand-accent",disabled:"file"!==f.submissionType&&f.submissionType!==S}),e.jsx("span",{className:"text-brand-primary-text",children:"File Upload"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"link",checked:"link"===S,onChange:e=>$(e.target.value),className:"mr-2 text-brand-accent focus:ring-brand-accent",disabled:"link"!==f.submissionType&&f.submissionType!==S}),e.jsx("span",{className:"text-brand-primary-text",children:"Link Submission"})]})]})]}),"file"===S&&e.jsx(o,{label:"Upload your assignment file",accept:".pdf,.doc,.docx,.txt,.zip,.rar",onFileSelect:D,error:M.file,helperText:"Accepted formats: PDF, DOC, DOCX, TXT, ZIP, RAR",fullWidth:!0}),"link"===S&&e.jsx(h,{label:"Assignment Link",type:"url",value:B,onChange:e=>V(e.target.value),placeholder:"https://example.com/your-assignment",error:M.link,helperText:"Enter the URL to your assignment (e.g., Google Drive, GitHub, etc.)",fullWidth:!0}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[e.jsx(l,{type:"button",variant:"secondary",onClick:O,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(l,{type:"submit",disabled:z,className:"w-full sm:w-auto",children:z?"Submitting...":"Submit Assignment"})]})]})]})})}),e.jsx(m,{isOpen:R,onClose:()=>L(!1),title:"Assignment Submitted!",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"text-green-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-xl font-semibold text-brand-primary-text mb-2 font-serif",children:"Successfully Submitted!"}),e.jsx("p",{className:"text-brand-secondary-text mb-6",children:"Your assignment has been submitted successfully. You'll receive feedback from your instructor soon."}),e.jsxs("div",{className:"flex space-x-3 justify-center",children:[e.jsx(l,{variant:"secondary",onClick:()=>L(!1),children:"View Submission"}),e.jsx(l,{onClick:O,children:"Back to Course"})]})]})})]})})},SubmissionHistory:()=>{const a=t(),{token:m}=i(),[o,h]=s.useState([]),[x,b]=s.useState(!0),[u,p]=s.useState(null),[f,v]=s.useState("all");s.useEffect(()=>{m&&y()},[m]);const y=async()=>{try{b(!0),p(null);const e=await fetch("http://localhost:5000/api/students/submissions",{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});if(!e.ok){const a=await e.json();throw new Error(a.error||"Failed to fetch submissions")}const a=await e.json();h(a.submissions||[])}catch(e){p(e instanceof Error?e.message:"An error occurred")}finally{b(!1)}},N=o.filter(e=>"all"===f||e.status===f),w=e=>{switch(e){case"submitted":case"reviewed":return"success";case"late":return"warning";default:return"default"}},g=e=>{switch(e){case"submitted":case"reviewed":return"âœ“";case"late":return"âš ";case"pending":return"â³";default:return""}},C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return x?e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{"data-testid":"loading-spinner",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-accent mx-auto mb-4"}),e.jsx("p",{className:"text-brand-secondary-text",children:"Loading submissions..."})]})}):u?e.jsx("div",{className:"min-h-screen bg-brand-primary-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("h2",{className:"text-xl font-semibold text-brand-primary-text mb-2 font-serif",children:"Unable to Load Submissions"}),e.jsx("p",{className:"text-brand-secondary-text mb-6",children:u}),e.jsx(l,{onClick:()=>a("/dashboard"),children:"Back to Dashboard"})]})}):e.jsx("div",{className:"min-h-screen bg-brand-primary-bg",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsx(c,{children:e.jsxs("div",{className:"mb-8",children:[e.jsx(l,{variant:"tertiary",onClick:()=>a("/dashboard"),className:"mb-4 text-brand-accent hover:text-brand-accent",children:"â† Back to Dashboard"}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-brand-primary-text font-serif mb-2",children:"Submission History"}),e.jsx("p",{className:"text-lg text-brand-secondary-text",children:"View all your assignment submissions and feedback"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-brand-secondary-text mb-2",children:"Total Submissions"}),e.jsx("div",{className:"text-2xl font-bold text-brand-primary-text",children:o.length})]})]}),e.jsx("div",{className:"border-b border-brand-secondary-text/20",children:e.jsx("nav",{className:"flex space-x-8",children:[{key:"all",label:"All",count:o.length},{key:"submitted",label:"Submitted",count:o.filter(e=>"submitted"===e.status).length},{key:"late",label:"Late",count:o.filter(e=>"late"===e.status).length},{key:"reviewed",label:"Reviewed",count:o.filter(e=>"reviewed"===e.status).length}].map(a=>e.jsxs("button",{onClick:()=>v(a.key),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors "+(f===a.key?"border-brand-accent text-brand-accent":"border-transparent text-brand-secondary-text hover:text-brand-primary-text hover:border-brand-secondary-text"),children:[a.label," (",a.count,")"]},a.key))})})]})}),e.jsx("div",{className:"space-y-6",children:N.length>0?N.map(t=>e.jsx(d,{children:e.jsx(n,{className:"hover:shadow-lg transition-all duration-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-primary-text font-serif mb-1",children:t.assignment.title}),e.jsxs("p",{className:"text-sm text-brand-secondary-text mb-2",children:["ðŸ“š ",t.assignment.course.title]}),e.jsx("p",{className:"text-brand-secondary-text text-sm",children:t.assignment.description.length>100?`${t.assignment.description.substring(0,100)}...`:t.assignment.description})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(r,{variant:"default",children:t.submissionType}),e.jsxs(r,{variant:w(t.status),children:[g(t.status)," ",t.status]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 p-4 bg-brand-primary-bg rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-brand-secondary-text",children:"Submitted:"}),e.jsx("p",{className:"text-brand-primary-text font-medium",children:C(t.submittedAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-brand-secondary-text",children:"Deadline:"}),e.jsx("p",{className:"text-brand-primary-text font-medium",children:C(t.assignment.deadline)})]}),t.fileUrl&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-brand-secondary-text",children:"File:"}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>window.open(t.fileUrl,"_blank"),className:"text-brand-accent hover:text-brand-accent ml-2",children:"View File"})]}),t.linkUrl&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-brand-secondary-text",children:"Link:"}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>window.open(t.linkUrl,"_blank"),className:"text-brand-accent hover:text-brand-accent ml-2",children:"Open Link"})]})]}),t.feedback&&t.feedback.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-brand-accent border-opacity-20",children:[e.jsx("h4",{className:"text-md font-semibold text-brand-primary-text font-serif mb-3",children:"Instructor Feedback"}),e.jsx("div",{className:"space-y-3",children:t.feedback.map(a=>e.jsxs("div",{className:"bg-brand-secondary-bg rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-brand-primary-text",children:[a.instructor.firstName," ",a.instructor.lastName]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a.rating&&e.jsxs(r,{variant:"default",children:["â­ ",a.rating,"/5"]}),e.jsx("span",{className:"text-sm text-brand-secondary-text",children:C(a.createdAt)})]})]}),e.jsx("p",{className:"text-brand-secondary-text",children:a.comment})]},a.id))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx(l,{variant:"secondary",size:"sm",onClick:()=>{return e=t.assignment.course.id,void a(`/courses/${e}/content`);var e},children:"View Course"}),e.jsx(l,{variant:"tertiary",size:"sm",onClick:()=>{return e=t.assignment.id,void a(`/assignments/${e}`);var e},className:"text-brand-accent hover:text-brand-accent",children:"View Assignment"})]})]})})},t.id)):e.jsx(d,{children:e.jsx(n,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-brand-secondary-text mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-lg font-semibold text-brand-primary-text mb-2 font-serif",children:"all"===f?"No Submissions Yet":`No ${f} Submissions`}),e.jsx("p",{className:"text-brand-secondary-text mb-6",children:"all"===f?"You haven't submitted any assignments yet. Check your courses for available assignments.":`You don't have any ${f} submissions.`}),e.jsx(l,{onClick:()=>a("/dashboard"),children:"Go to Dashboard"})]})})})})]})})}},Symbol.toStringTag,{value:"Module"}));export{x as L,f as a,u as i};
