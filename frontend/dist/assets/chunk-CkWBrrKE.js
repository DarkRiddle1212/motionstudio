import{r as e,j as t}from"./chunk-CJk5566G.js";import{u as r,A as a,S as s,B as l,b as n}from"./chunk-6oSn1JRi.js";import{D as i}from"./chunk-B2YaEX5v.js";import"./chunk-BXbIpaFw.js";const o="http://localhost:5000/api",d=({onClose:r,onSuccess:a,token:s})=>{const[l,n]=e.useState({email:"",password:"",firstName:"",lastName:"",role:"instructor"}),[i,d]=e.useState(!1),[c,u]=e.useState(null);return t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[t.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:r}),t.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Create New User"}),c&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:c}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s){d(!0),u(null);try{const e=await fetch(`${o}/api/admin/users`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to create user")}a()}catch(t){u(t instanceof Error?t.message:"An error occurred")}finally{d(!1)}}},className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),t.jsx("input",{type:"email",value:l.email,onChange:e=>n({...l,email:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),t.jsx("input",{type:"password",value:l.password,onChange:e=>n({...l,password:e.target.value}),required:!0,minLength:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),t.jsx("input",{type:"text",value:l.firstName,onChange:e=>n({...l,firstName:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),t.jsx("input",{type:"text",value:l.lastName,onChange:e=>n({...l,lastName:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),t.jsxs("select",{value:l.role,onChange:e=>n({...l,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"student",children:"Student"}),t.jsx("option",{value:"instructor",children:"Instructor"}),t.jsx("option",{value:"admin",children:"Admin"})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:i?"Creating...":"Create User"})]})]})]})]})})},c=({user:r,onClose:a,onSuccess:s,token:l})=>{const[n,i]=e.useState({firstName:r.firstName||"",lastName:r.lastName||"",role:r.role}),[d,c]=e.useState(!1),[u,m]=e.useState(null);return t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[t.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:a}),t.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Edit User"}),t.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[t.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",t.jsx("span",{className:"font-medium",children:r.email})]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Status:",t.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium rounded-full "+(r.emailVerified?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:r.emailVerified?"Active":"Suspended"})]})]}),u&&t.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:u}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),l){c(!0),m(null);try{const e=await fetch(`${o}/api/admin/users/${r.id}`,{method:"PUT",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to update user")}s()}catch(t){m(t instanceof Error?t.message:"An error occurred")}finally{c(!1)}}},className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),t.jsx("input",{type:"text",value:n.firstName,onChange:e=>i({...n,firstName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),t.jsx("input",{type:"text",value:n.lastName,onChange:e=>i({...n,lastName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),t.jsxs("select",{value:n.role,onChange:e=>i({...n,role:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"student",children:"Student"}),t.jsx("option",{value:"instructor",children:"Instructor"}),t.jsx("option",{value:"admin",children:"Admin"})]})]}),t.jsx("div",{className:"border-t border-gray-200 pt-4",children:t.jsx("button",{type:"button",onClick:async()=>{if(l){c(!0),m(null);try{const e=r.emailVerified?"suspend":"activate",t=await fetch(`${o}/api/admin/users/${r.id}/${e}`,{method:"POST",headers:{Authorization:`Bearer ${l}`}});if(!t.ok){const r=await t.json();throw new Error(r.error||`Failed to ${e} user`)}s()}catch(e){m(e instanceof Error?e.message:"An error occurred")}finally{c(!1)}}},disabled:d,className:`w-full px-4 py-2 text-sm font-medium rounded-lg ${r.emailVerified?"text-red-700 bg-red-50 hover:bg-red-100":"text-green-700 bg-green-50 hover:bg-green-100"} disabled:opacity-50`,children:r.emailVerified?"Suspend Account":"Activate Account"})}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:d?"Saving...":"Save Changes"})]})]})]})]})})},u=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{token:u}=r(),[m,h]=e.useState([]),[g,p]=e.useState(!0),[b,x]=e.useState(null),[y,f]=e.useState([]),[v,N]=e.useState({page:1,pageSize:10,totalItems:0}),[w,k]=e.useState({column:"createdAt",direction:"desc"}),[C,S]=e.useState(""),[$,A]=e.useState({}),[j,z]=e.useState(!1),[P,M]=e.useState(!1),[L,E]=e.useState(null),O=e.useCallback(async()=>{if(u){p(!0),x(null);try{const e=new URLSearchParams;e.append("page",v.page.toString()),e.append("pageSize",v.pageSize.toString()),C&&e.append("search",C),$.role&&e.append("role",$.role),w.column&&(e.append("sortBy",w.column),e.append("sortOrder",w.direction||"desc"));const t=await fetch(`${o}/api/admin/users?${e}`,{headers:{Authorization:`Bearer ${u}`}});if(!t.ok)throw new Error("Failed to fetch users");const r=await t.json();h(r.users),N(e=>({...e,totalItems:r.pagination.totalItems}))}catch(e){x(e instanceof Error?e.message:"An error occurred")}finally{p(!1)}}},[u,v.page,v.pageSize,C,$,w]);e.useEffect(()=>{O()},[O]);const T=e.useCallback(e=>{S(e),N(e=>({...e,page:1}))},[]),B=e.useCallback(e=>{A(e),N(e=>({...e,page:1}))},[]),I=e.useCallback((e,t)=>{k({column:e,direction:t})},[]),D=e.useCallback(e=>{N(t=>({...t,page:e}))},[]),F=e.useCallback(e=>{N(t=>({...t,pageSize:e,page:1}))},[]),U=[{id:"email",header:"Email",accessor:"email",sortable:!0},{id:"name",header:"Name",accessor:e=>`${e.firstName||""} ${e.lastName||""}`.trim()||"—",sortable:!0},{id:"role",header:"Role",accessor:"role",sortable:!0,render:e=>t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+("admin"===e?"bg-purple-100 text-purple-700":"instructor"===e?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.charAt(0).toUpperCase()+e.slice(1)})},{id:"status",header:"Status",accessor:"emailVerified",render:e=>t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(e?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:e?"Active":"Suspended"})},{id:"enrollments",header:"Enrollments",accessor:"enrollmentCount",align:"center",hiddenOnMobile:!0},{id:"createdAt",header:"Joined",accessor:e=>new Date(e.createdAt).toLocaleDateString(),sortable:!0,hiddenOnMobile:!0},{id:"actions",header:"Actions",accessor:()=>null,render:(e,r)=>t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{onClick:e=>{e.stopPropagation(),E(r),M(!0)},className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Edit user",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})})})}],R=[{id:"activate",label:"Activate",icon:n.Activate,action:async e=>{if(u){for(const t of e)await fetch(`${o}/api/admin/users/${t.id}/activate`,{method:"POST",headers:{Authorization:`Bearer ${u}`}});f([]),O()}}},{id:"suspend",label:"Suspend",icon:n.Suspend,action:async e=>{if(u){for(const t of e)await fetch(`${o}/api/admin/users/${t.id}/suspend`,{method:"POST",headers:{Authorization:`Bearer ${u}`}});f([]),O()}},confirmationMessage:"Are you sure you want to suspend the selected users? They will not be able to log in."},{id:"delete",label:"Delete",icon:n.Delete,action:async e=>{if(u){for(const t of e)await fetch(`${o}/api/admin/users/${t.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${u}`}});f([]),O()}},variant:"danger",confirmationMessage:"Are you sure you want to delete the selected users? This action cannot be undone."}],W={page:v.page,pageSize:v.pageSize,totalItems:v.totalItems,onPageChange:D,onPageSizeChange:F,pageSizeOptions:[10,25,50,100]},_={column:w.column,direction:w.direction,onSort:I},J=m.filter(e=>y.includes(e.id));return t.jsx(a,{title:"User Management",breadcrumbs:[{label:"Admin",href:"/admin"},{label:"Users"}],children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[t.jsx("div",{children:t.jsx("p",{className:"text-gray-600",children:"Manage all platform users including students, instructors, and administrators."})}),t.jsxs("button",{onClick:()=>z(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add User"]})]}),t.jsx(s,{searchPlaceholder:"Search by email, name...",filters:[{key:"role",label:"Role",type:"select",options:[{label:"Student",value:"student"},{label:"Instructor",value:"instructor"},{label:"Admin",value:"admin"}]}],onSearch:T,onFilter:B,searchValue:C,filterValues:$}),t.jsx(l,{selectedItems:J,actions:R,onClearSelection:()=>f([]),itemLabel:"user"}),b&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:b}),t.jsx(i,{data:m,columns:U,loading:g,pagination:W,sorting:_,selectable:!0,selectedIds:y,onSelectionChange:f,emptyMessage:"No users found",onRowClick:e=>{E(e),M(!0)}}),j&&t.jsx(d,{onClose:()=>z(!1),onSuccess:()=>{z(!1),O()},token:u}),P&&L&&t.jsx(c,{user:L,onClose:()=>{M(!1),E(null)},onSuccess:()=>{M(!1),E(null),O()},token:u})]})})}},Symbol.toStringTag,{value:"Module"})),m="http://localhost:5000/api",h=({course:r,loading:a,onClose:s,onPublishToggle:l})=>{const[n,i]=e.useState("overview");return a?t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[t.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:s}),t.jsx("div",{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full p-6",children:t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})})]})}):t.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:t.jsxs("div",{className:"flex min-h-full items-center justify-center p-4",children:[t.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75",onClick:s}),t.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r.title}),t.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["By ",r.instructor.firstName," ",r.instructor.lastName," (",r.instructor.email,")"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full "+(r.isPublished?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:r.isPublished?"Published":"Draft"}),t.jsx("button",{onClick:s,className:"p-1 text-gray-400 hover:text-gray-500",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),t.jsx("div",{className:"border-b border-gray-200",children:t.jsx("nav",{className:"flex -mb-px px-6",children:["overview","lessons","assignments","enrollments"].map(e=>t.jsxs("button",{onClick:()=>i(e),className:"py-3 px-4 text-sm font-medium border-b-2 transition-colors "+(n===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.charAt(0).toUpperCase()+e.slice(1),"lessons"===e&&` (${r.lessons.length})`,"assignments"===e&&` (${r.assignments.length})`,"enrollments"===e&&` (${r.t.enrollments})`]},e))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:["overview"===n&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.t.enrollments}),t.jsx("div",{className:"text-sm text-gray-500",children:"Enrollments"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.t.lessons}),t.jsx("div",{className:"text-sm text-gray-500",children:"Lessons"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r.t.assignments}),t.jsx("div",{className:"text-sm text-gray-500",children:"Assignments"})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-900",children:0===r.pricing?"Free":`${r.currency} ${r.pricing}`}),t.jsx("div",{className:"text-sm text-gray-500",children:"Price"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Description"}),t.jsx("p",{className:"text-gray-600",children:r.description})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Duration"}),t.jsx("p",{className:"text-gray-600",children:r.duration})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Created"}),t.jsx("p",{className:"text-gray-600",children:new Date(r.createdAt).toLocaleDateString()})]})]}),t.jsx("div",{className:"pt-4 border-t border-gray-200",children:t.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium rounded-lg "+(r.isPublished?"text-yellow-700 bg-yellow-50 hover:bg-yellow-100":"text-green-700 bg-green-50 hover:bg-green-100"),children:r.isPublished?"Unpublish Course":"Publish Course"})})]}),"lessons"===n&&t.jsx("div",{className:"space-y-4",children:0===r.lessons.length?t.jsx("p",{className:"text-gray-500 text-center py-8",children:"No lessons in this course yet."}):r.lessons.map(e=>t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:e.order}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.title}),t.jsx("div",{className:"text-sm text-gray-500",children:e.description})]})]}),t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(e.isPublished?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:e.isPublished?"Published":"Draft"})]},e.id))}),"assignments"===n&&t.jsx("div",{className:"space-y-4",children:0===r.assignments.length?t.jsx("p",{className:"text-gray-500 text-center py-8",children:"No assignments in this course yet."}):r.assignments.map(e=>t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.title}),t.jsx("div",{className:"text-sm text-gray-500 mt-1",children:e.description})]}),t.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-700",children:[e.t.submissions," submissions"]})]}),t.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-500",children:[t.jsxs("span",{children:["Type: ",e.submissionType]}),t.jsxs("span",{children:["Deadline: ",new Date(e.deadline).toLocaleDateString()]})]})]},e.id))}),"enrollments"===n&&t.jsx("div",{className:"space-y-4",children:0===r.enrollments.length?t.jsx("p",{className:"text-gray-500 text-center py-8",children:"No students enrolled in this course yet."}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Student"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Enrolled"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Progress"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase",children:"Status"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.enrollments.map(e=>t.jsxs("tr",{children:[t.jsxs("td",{className:"px-4 py-3",children:[t.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[e.student.firstName," ",e.student.lastName]}),t.jsx("div",{className:"text-xs text-gray-500",children:e.student.email})]}),t.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(e.enrolledAt).toLocaleDateString()}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${e.progressPercentage}%`}})}),t.jsxs("span",{className:"text-sm text-gray-600",children:[e.progressPercentage,"%"]})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+("completed"===e.status?"bg-green-100 text-green-700":"active"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]},e.id))})]})})})]})]})]})})},g=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{token:o}=r(),[d,c]=e.useState([]),[u,g]=e.useState(!0),[p,b]=e.useState(null),[x,y]=e.useState([]),[f,v]=e.useState({page:1,pageSize:10,totalItems:0}),[N,w]=e.useState({column:"createdAt",direction:"desc"}),[k,C]=e.useState(""),[S,$]=e.useState({}),[A,j]=e.useState(!1),[z,P]=e.useState(null),[M,L]=e.useState(!1),E=e.useCallback(async()=>{if(o){g(!0),b(null);try{const e=new URLSearchParams;e.append("page",f.page.toString()),e.append("pageSize",f.pageSize.toString()),k&&e.append("search",k),S.status&&e.append("status",S.status),N.column&&(e.append("sortBy",N.column),e.append("sortOrder",N.direction||"desc"));const t=await fetch(`${m}/api/admin/courses?${e}`,{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error("Failed to fetch courses");const r=await t.json();c(r.courses),v(e=>({...e,totalItems:r.pagination.totalItems}))}catch(e){b(e instanceof Error?e.message:"An error occurred")}finally{g(!1)}}},[o,f.page,f.pageSize,k,S,N]);e.useEffect(()=>{E()},[E]);const O=e.useCallback(async e=>{if(o){L(!0);try{const t=await fetch(`${m}/api/admin/courses/${e}`,{headers:{Authorization:`Bearer ${o}`}});if(!t.ok)throw new Error("Failed to fetch course details");const r=await t.json();P(r),j(!0)}catch(t){b(t instanceof Error?t.message:"An error occurred")}finally{L(!1)}}},[o]),T=e.useCallback(e=>{C(e),v(e=>({...e,page:1}))},[]),B=e.useCallback(e=>{$(e),v(e=>({...e,page:1}))},[]),I=e.useCallback((e,t)=>{w({column:e,direction:t})},[]),D=e.useCallback(e=>{v(t=>({...t,page:e}))},[]),F=e.useCallback(e=>{v(t=>({...t,pageSize:e,page:1}))},[]),U=async e=>{if(o)try{if(!(await fetch(`${m}/api/admin/courses/${e.id}/publish`,{method:"PATCH",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({isPublished:!e.isPublished})})).ok)throw new Error("Failed to update course status");E()}catch(t){b(t instanceof Error?t.message:"An error occurred")}},R=[{id:"title",header:"Title",accessor:"title",sortable:!0,render:(e,r)=>t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e}),t.jsx("div",{className:"text-xs text-gray-500 truncate max-w-xs",children:r.description})]})},{id:"instructor",header:"Instructor",accessor:e=>`${e.instructor.firstName||""} ${e.instructor.lastName||""}`.trim()||e.instructor.email,sortable:!1,render:(e,r)=>t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-900",children:`${r.instructor.firstName||""} ${r.instructor.lastName||""}`.trim()||"—"}),t.jsx("div",{className:"text-xs text-gray-500",children:r.instructor.email})]})},{id:"status",header:"Status",accessor:"isPublished",render:e=>t.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full "+(e?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"),children:e?"Published":"Draft"})},{id:"enrollments",header:"Enrollments",accessor:e=>e.t.enrollments,align:"center"},{id:"lessons",header:"Lessons",accessor:e=>e.t.lessons,align:"center",hiddenOnMobile:!0},{id:"pricing",header:"Price",accessor:"pricing",sortable:!0,render:(e,r)=>t.jsx("span",{className:"text-sm",children:0===e?t.jsx("span",{className:"text-green-600 font-medium",children:"Free"}):`${r.currency} ${e.toFixed(2)}`}),hiddenOnMobile:!0},{id:"createdAt",header:"Created",accessor:e=>new Date(e.createdAt).toLocaleDateString(),sortable:!0,hiddenOnMobile:!0},{id:"actions",header:"Actions",accessor:()=>null,render:(e,r)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),U(r)},className:"p-1 transition-colors "+(r.isPublished?"text-yellow-500 hover:text-yellow-600":"text-green-500 hover:text-green-600"),title:r.isPublished?"Unpublish":"Publish",children:r.isPublished?t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):t.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),O(r.id)},className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"View details",children:t.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})}],W=[{id:"publish",label:"Publish",icon:n.Activate,action:async e=>{if(!o)return;const t=e.map(e=>e.id);await fetch(`${m}/api/admin/courses/bulk/publish`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({courseIds:t,isPublished:!0})}),y([]),E()},confirmationMessage:"Are you sure you want to publish the selected courses? They will become visible to all users."},{id:"unpublish",label:"Unpublish",icon:n.Suspend,action:async e=>{if(!o)return;const t=e.map(e=>e.id);await fetch(`${m}/api/admin/courses/bulk/publish`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({courseIds:t,isPublished:!1})}),y([]),E()},confirmationMessage:"Are you sure you want to unpublish the selected courses? They will no longer be visible to users."},{id:"delete",label:"Delete",icon:n.Delete,action:async e=>{if(!o)return;const t=e.map(e=>e.id);await fetch(`${m}/api/admin/courses/bulk/delete`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({courseIds:t})}),y([]),E()},variant:"danger",confirmationMessage:"Are you sure you want to delete the selected courses? This action cannot be undone and will remove all associated lessons, assignments, and enrollments."}],_={page:f.page,pageSize:f.pageSize,totalItems:f.totalItems,onPageChange:D,onPageSizeChange:F,pageSizeOptions:[10,25,50,100]},J={column:N.column,direction:N.direction,onSort:I},V=d.filter(e=>x.includes(e.id));return t.jsx(a,{title:"Course Management",breadcrumbs:[{label:"Admin",href:"/admin"},{label:"Courses"}],children:t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:t.jsx("div",{children:t.jsx("p",{className:"text-gray-600",children:"Manage all courses, control publication status, and view enrollment data."})})}),t.jsx(s,{searchPlaceholder:"Search by title, description, or instructor...",filters:[{key:"status",label:"Status",type:"select",options:[{label:"Published",value:"published"},{label:"Draft",value:"draft"}]}],onSearch:T,onFilter:B,searchValue:k,filterValues:S}),t.jsx(l,{selectedItems:V,actions:W,onClearSelection:()=>y([]),itemLabel:"course"}),p&&t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:p}),t.jsx(i,{data:d,columns:R,loading:u,pagination:_,sorting:J,selectable:!0,selectedIds:x,onSelectionChange:y,emptyMessage:"No courses found",onRowClick:e=>O(e.id)}),A&&z&&t.jsx(h,{course:z,loading:M,onClose:()=>{j(!1),P(null)},onPublishToggle:()=>{U(z),j(!1),P(null)}})]})})}},Symbol.toStringTag,{value:"Module"}));export{g as C,u as U};
